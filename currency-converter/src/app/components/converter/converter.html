<div class="converter">
  <h2>Currency Converter</h2>

  <div class="rate-box">
    <span>Real rate: {{ realRate$ | async }}</span>
    <span *ngIf="forcedRate$ | async as forced; else noForced">
      Forced: {{ forced }}
    </span>
    <ng-template #noForced>
      <span>No forced rate</span>
    </ng-template>
  </div>

  <div class="switch">
    <span [class.active]="mode() === 'EUR'">EUR</span>
    <button (click)="switchMode()">â‡„</button>
    <span [class.active]="mode() === 'USD'">USD</span>
  </div>

  <div class="field">
    <label>Input ({{ mode() }})</label>
    <input type="number" [formControl]="inputControl" />
  </div>

  <div class="field">
    <label>Output ({{ mode() === 'EUR' ? 'USD' : 'EUR' }})</label>
    <div class="output">{{ output() }}</div>
  </div>

  <div class="forced" [formGroup]="forcedRateForm">
    <label>
      <input type="checkbox" formControlName="enabled" />
      Force exchange rate
    </label>

    <input
      type="number"
      step="0.0001"
      formControlName="rate"
      [disabled]="!forcedRateForm.value.enabled"
    />

    <div *ngIf="forcedDisabledByDeviation()" class="warning">
      Forced rate disabled (deviation &gt; 2%)
    </div>
  </div>

  <app-history-table></app-history-table>
</div>
